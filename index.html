<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <meta name="theme-color" content="#317EFB">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" href="icons/icon.webp" />
    <link rel="apple-touch-icon" href="icons/icon.webp">

    <title>StarShip</title>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker
                    .register('serviceworker.js')
                    .then(reg => console.log('Service Worker: Registered (Pages)'))
                    .catch(err => console.log(`Service Worker: Error: ${err}`));
            });
        }
    </script>

    <link rel="stylesheet" href="displayComponents/style.css">
    <link rel="stylesheet" href="displayComponents/dispComponents.css">
</head>

<body>
    <canvas id="mainView" ontouchmove="windowResize()"></canvas>

    <div id="FlightParamDisp">
        <div id="FlightParamDispL" style="transform: translate(0,-15px);">
            <p id="altitudeDisp" style="font-size: 20px;"></p>
            <p>Fuel: <span id="propellantMassDisp"></span>t</p>
            <p class="dispSizeAdjustmentBtn" onclick="zoomOut()" style="padding-left: 15px;">-</p>
        </div>


        <div id="FlightParamDispMid"
            style="font-size: smaller; display: flex; flex-direction:column;align-items: center;justify-content: center;text-align: center;transition-duration: 0.1s;">

            <div onclick="show_hideMenuView()">
                <p>Base: <span id="distanceToLandingSite"></span></p>
                <p>SpeedX: <span id="speedX"></span></p>
                <p>SpeedY: <span id="speedY"></span></p>
                <p>G: <span id="gforece"></span></p>

            </div>
            <div id="mainViewButtonsArea">

                <button id="RestartBtn" class="mainPageBtn" onclick="restart()">Restart</button>
                <button id="showPlotViewButton" class="mainPageBtn"
                    style="display: none; background-color: transparent;" onclick="show_hidePlotView()">FDR</button>
                <button id="requestTiltPermissionBtn" class="mainPageBtn">Tap me!</button>

            </div>
        </div>


        <div id="FlightParamDispR" style="transform: translate(0,-15px);">
            <p id="speedDisp" style="font-size: 20px;"><span></span></p>
            <p>TWR: <span id="twrDisp"></span></p>
            <p class="dispSizeAdjustmentBtn" onclick="zoomIn()" style="padding-right: 15px;">+</p>
        </div>
    </div>

    <div id="flightControl">
        <div id="controlsL" class="hideableControls"
            style="display: flex;flex-direction: row;align-items: center;justify-content: center;text-align: center; position: absolute; bottom: calc(45% - 110px); left: 10px;;transform: translate(-100%, 0);">
            <div style="display: grid; grid-template-columns: auto auto auto auto;grid-gap: 1px;padding: 2px;">
                <input type="range" class="slider" id="throttleControl"
                    style="grid-column-start: 1;grid-column-end: 4;"><br>
                <button id="raptor1toggle" class="controlBtn" onclick="toggleRaptor1()">R1</button>
                <button id="raptor2toggle" class="controlBtn" onclick="toggleRaptor2()">R2</button>
                <button id="raptor3toggle" class="controlBtn" onclick="toggleRaptor3()">R3</button>
                <button id="allraptorstoggle" class="controlBtn" onclick="toggleAllRaptors()"
                    style="grid-column-start: 1;grid-column-end: 4;">Toggle-All</button>
            </div>
            <img class="show_hideToggle" src="displayComponents/straightButton.webp" alt="hide/show" height="70"
                onclick="show_hidecontrolsL()" style="height: 70px; transform: translate(0,3px);">
        </div>

        <div id="controlsR" class="hideableControls"
            style="display: flex;flex-direction: row-reverse;align-items: center;justify-content: center;text-align: center; position: absolute; bottom: calc(45% - 110px); right: 10px;transform: translate(100%, 0);">
            <div
                style="display: flex;flex-direction: column;align-items: flex-end;justify-content: center;text-align: center;">
                <div id="attitudeControl" style="text-align: center;">
                    <input type="range" class="slider" id="pitchControl" onmouseover="manualPitchControlOn()"
                        onmouseout="recordHoldingPitch_resumeAuto()" ontouchstart="manualPitchControlOn()"
                        ontouchend="recordHoldingPitch_resumeAuto()">
                </div>
                <div style="display: flex;flex-wrap: wrap;">
                    <button class="controlBtn" id="togglePitchHold" onclick="togglePitchHold()">AttitHold</button>
                    <button class="controlBtn" id="toggleAutoLand" onclick="toggleAutoLand()">AutoLand</button>
                </div>
                <div id="controlToggles" style="display: flex;flex-wrap: wrap;">
                    <button class="controlBtn" id="toggleFin" onclick="toggleFin()">Fins</button>
                    <button class="controlBtn" id="toggleRcs" onclick="toggleRcs()">RCS</button>
                    <button class="controlBtn" id="toggledumpFuel" onclick="toggleDumpFuel()">DumpFuel</button>
                </div>
            </div>

            <img class="show_hideToggle" src="displayComponents/straightButton.webp" alt="hide/show" height="70"
                onclick="show_hidecontrolsR()" style="height: 70px; transform: translate(0,0);">
        </div>

    </div>



    <div id="plotView" class="hiddenFullScreenView">
        <div id="close_PlotView" style="height: 20%;" onclick="show_hidePlotView()"></div>
        <div id="plots">
            <div id="flyPathPlot"></div>
            <div id="motionSpeedPlot"></div>
            <div id="motionAnglePlot"></div>
            <div id="accelerationPlot"></div>
            <div id="controlInPutPlot"></div>
            <div id="thermalPower_dynamicPressurePlot"></div>
            <div id="aerodynamicForcePlot"></div>
            <div id="altitudePlot"></div>
        </div>
    </div>

    <div id="menuView" class="hiddenFullScreenView">
        <div id="close_MenuView" style="height: 20%;" onclick="show_hideMenuView()"></div>
        <div id="menuContent">
            <button id="toggleTiltControl" onclick="toggleTiltControl()"
                style="width: 100%;height: 100%;">TiltControl</button>
        </div>

    </div>
</body>


<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
<script src="render/particleEffect/revoltfx.min.js"></script>

<script type="text/javascript" src="utilities/tools.js"></script>

<script type="text/javascript" src="backend/utilities/tools.js"></script>
<script type="text/javascript" src="backend/utilities/plotting.js"></script>
<script type="text/javascript" src="backend/utilities/switches.js"></script>

<script type="text/javascript" src="backend/physics.js"></script>
<script type="text/javascript" src="backend/updateBackEnd.js"></script>

<script type="text/javascript" src="backend/flightcontrol/flightControl.js"></script>
<script type="text/javascript" src="backend/flightcontrol/autoPilotLowLevelFunctions.js"></script>
<script type="text/javascript" src="backend/flightcontrol/autoPilotModes.js"></script>
<script type="text/javascript" src="backend/initBackEnd.js"></script>

<script type="text/javascript" src="render/initGroundObjects.js"></script>
<script type="text/javascript" src="displayComponents/dispUpdate.js"></script>
<script type="text/javascript" src="render/drawMethods/drawMethods.js"></script>
<script type="text/javascript" src="render/drawMethods/initDrawMethods.js"></script>
<script type="text/javascript" src="render/pixi_setup.js"></script>

<script type="text/javascript" src="render/pixi_init.js"></script>

<script type="text/javascript" src="utilities/eventListener.js"></script>

<script src='https://cdn.plot.ly/plotly-latest.min.js'></script>

</html>